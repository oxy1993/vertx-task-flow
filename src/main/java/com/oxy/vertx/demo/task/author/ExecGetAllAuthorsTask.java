package com.oxy.vertx.demo.task.author;

import com.fasterxml.jackson.core.type.TypeReference;
import com.oxy.vertx.base.OxyTask;
import com.oxy.vertx.base.utils.JsonUtils;
import com.oxy.vertx.demo.dto.AuthorDTO;
import com.oxy.vertx.demo.msg.ExecGetAllAuthorsMsg;
import com.oxy.vertx.demo.msg.GetAllAuthorsResponseMsg;
import io.vertx.core.Handler;

import java.util.List;

public class ExecGetAllAuthorsTask extends OxyTask<ExecGetAllAuthorsMsg> {
    @Override
    protected void exec(ExecGetAllAuthorsMsg input, Handler<ExecGetAllAuthorsMsg> nextTask) {
        GetAllAuthorsResponseMsg responseMsg = input.createResponse(GetAllAuthorsResponseMsg.class);
        String data = "[{\"id\":1,\"first_name\":\"Merritt\",\"last_name\":\"Kerluke\",\"email\":\"kertzmann.jeremie@example.net\",\"birthdate\":\"1980-01-08\",\"added\":\"1993-01-07T07:47:18Z\"},{\"id\":2,\"first_name\":\"Karson\",\"last_name\":\"Davis\",\"email\":\"alexandria.kutch@example.net\",\"birthdate\":\"2021-03-10\",\"added\":\"1992-03-08T04:26:39Z\"},{\"id\":3,\"first_name\":\"Dina\",\"last_name\":\"Johnston\",\"email\":\"jakubowski.whitney@example.com\",\"birthdate\":\"2000-11-29\",\"added\":\"2005-12-20T08:03:35Z\"},{\"id\":4,\"first_name\":\"Janie\",\"last_name\":\"Kuhn\",\"email\":\"colby.kunze@example.org\",\"birthdate\":\"1972-08-03\",\"added\":\"1982-09-22T12:27:06Z\"},{\"id\":5,\"first_name\":\"Anthony\",\"last_name\":\"Goodwin\",\"email\":\"fzemlak@example.com\",\"birthdate\":\"2009-10-09\",\"added\":\"1993-12-30T19:31:04Z\"},{\"id\":6,\"first_name\":\"Noemi\",\"last_name\":\"Dooley\",\"email\":\"crona.adelbert@example.org\",\"birthdate\":\"1995-07-23\",\"added\":\"1995-11-19T04:25:20Z\"},{\"id\":7,\"first_name\":\"Brendon\",\"last_name\":\"Johnson\",\"email\":\"trussel@example.org\",\"birthdate\":\"1991-12-17\",\"added\":\"2009-10-23T07:12:59Z\"},{\"id\":8,\"first_name\":\"Claudine\",\"last_name\":\"O'Keefe\",\"email\":\"iwehner@example.org\",\"birthdate\":\"2019-07-11\",\"added\":\"1980-08-04T11:44:58Z\"},{\"id\":9,\"first_name\":\"Viviane\",\"last_name\":\"Bosco\",\"email\":\"roberts.caitlyn@example.com\",\"birthdate\":\"2016-10-27\",\"added\":\"1971-05-27T01:25:46Z\"},{\"id\":10,\"first_name\":\"Jaycee\",\"last_name\":\"Frami\",\"email\":\"daugherty.matteo@example.com\",\"birthdate\":\"1988-05-19\",\"added\":\"1978-04-07T03:31:00Z\"},{\"id\":11,\"first_name\":\"Rashad\",\"last_name\":\"Rowe\",\"email\":\"idella19@example.net\",\"birthdate\":\"2013-02-02\",\"added\":\"1987-02-05T21:52:27Z\"},{\"id\":12,\"first_name\":\"Kitty\",\"last_name\":\"Corkery\",\"email\":\"nyah03@example.org\",\"birthdate\":\"1992-05-26\",\"added\":\"1994-07-02T09:30:01Z\"},{\"id\":13,\"first_name\":\"Porter\",\"last_name\":\"Stiedemann\",\"email\":\"brice.parker@example.com\",\"birthdate\":\"1997-10-14\",\"added\":\"2011-02-26T03:20:21Z\"},{\"id\":14,\"first_name\":\"Marc\",\"last_name\":\"Kub\",\"email\":\"gzieme@example.org\",\"birthdate\":\"1975-06-12\",\"added\":\"2004-01-30T17:28:39Z\"},{\"id\":15,\"first_name\":\"Romaine\",\"last_name\":\"Goldner\",\"email\":\"eden57@example.com\",\"birthdate\":\"2017-10-03\",\"added\":\"2001-04-24T14:27:27Z\"},{\"id\":16,\"first_name\":\"Brian\",\"last_name\":\"Schaefer\",\"email\":\"feest.meredith@example.com\",\"birthdate\":\"1993-01-12\",\"added\":\"2017-12-28T15:53:07Z\"},{\"id\":17,\"first_name\":\"Abagail\",\"last_name\":\"Hilpert\",\"email\":\"treutel.lila@example.com\",\"birthdate\":\"1997-06-02\",\"added\":\"2012-10-05T10:23:12Z\"},{\"id\":18,\"first_name\":\"Jeremy\",\"last_name\":\"Stiedemann\",\"email\":\"reinger.delia@example.com\",\"birthdate\":\"2012-04-19\",\"added\":\"1976-04-23T20:47:52Z\"},{\"id\":19,\"first_name\":\"Mckenna\",\"last_name\":\"Pouros\",\"email\":\"lilliana66@example.net\",\"birthdate\":\"1991-11-26\",\"added\":\"1985-12-20T08:58:44Z\"},{\"id\":20,\"first_name\":\"Citlalli\",\"last_name\":\"Wuckert\",\"email\":\"felicita62@example.net\",\"birthdate\":\"1987-08-22\",\"added\":\"2020-05-05T08:25:43Z\"},{\"id\":21,\"first_name\":\"Jordi\",\"last_name\":\"Koch\",\"email\":\"pedro29@example.com\",\"birthdate\":\"2000-05-18\",\"added\":\"2003-03-02T12:13:35Z\"},{\"id\":22,\"first_name\":\"Waylon\",\"last_name\":\"Gleason\",\"email\":\"cristian.rowe@example.org\",\"birthdate\":\"2000-04-18\",\"added\":\"2017-07-09T23:05:19Z\"},{\"id\":23,\"first_name\":\"Maxwell\",\"last_name\":\"Goodwin\",\"email\":\"doyle.jed@example.org\",\"birthdate\":\"2008-10-17\",\"added\":\"1989-06-05T18:50:10Z\"},{\"id\":24,\"first_name\":\"Antwon\",\"last_name\":\"Brekke\",\"email\":\"zwindler@example.net\",\"birthdate\":\"1989-12-18\",\"added\":\"1985-05-10T06:26:52Z\"},{\"id\":25,\"first_name\":\"Thurman\",\"last_name\":\"Strosin\",\"email\":\"hayes.reba@example.org\",\"birthdate\":\"2001-07-17\",\"added\":\"1984-03-17T06:26:02Z\"},{\"id\":26,\"first_name\":\"Cruz\",\"last_name\":\"Kuhic\",\"email\":\"ray.mueller@example.com\",\"birthdate\":\"1970-12-11\",\"added\":\"2000-02-17T13:38:47Z\"},{\"id\":27,\"first_name\":\"Aric\",\"last_name\":\"Fay\",\"email\":\"cheyenne96@example.com\",\"birthdate\":\"2015-04-15\",\"added\":\"1983-12-12T21:25:47Z\"},{\"id\":28,\"first_name\":\"Justyn\",\"last_name\":\"Berge\",\"email\":\"clarissa.dare@example.net\",\"birthdate\":\"1996-03-19\",\"added\":\"1977-10-01T09:01:11Z\"},{\"id\":29,\"first_name\":\"Myrna\",\"last_name\":\"Daugherty\",\"email\":\"gmonahan@example.net\",\"birthdate\":\"1971-04-09\",\"added\":\"1998-05-30T01:55:06Z\"},{\"id\":30,\"first_name\":\"Jada\",\"last_name\":\"Crooks\",\"email\":\"owisoky@example.org\",\"birthdate\":\"1974-06-08\",\"added\":\"1983-10-24T02:13:08Z\"},{\"id\":31,\"first_name\":\"Jeanie\",\"last_name\":\"Hahn\",\"email\":\"gdooley@example.org\",\"birthdate\":\"1995-01-18\",\"added\":\"2017-08-23T04:53:04Z\"},{\"id\":32,\"first_name\":\"Trudie\",\"last_name\":\"Abshire\",\"email\":\"kuhic.nakia@example.com\",\"birthdate\":\"1983-06-04\",\"added\":\"1999-10-21T23:30:49Z\"},{\"id\":33,\"first_name\":\"Ansley\",\"last_name\":\"Roob\",\"email\":\"rodriguez.myrna@example.com\",\"birthdate\":\"1999-05-02\",\"added\":\"1990-01-30T09:25:09Z\"},{\"id\":34,\"first_name\":\"Maiya\",\"last_name\":\"Dickinson\",\"email\":\"hermiston.blair@example.net\",\"birthdate\":\"1972-08-27\",\"added\":\"2020-09-09T01:46:17Z\"},{\"id\":35,\"first_name\":\"Juvenal\",\"last_name\":\"Gutkowski\",\"email\":\"jace02@example.net\",\"birthdate\":\"2016-10-12\",\"added\":\"1973-09-13T11:10:07Z\"},{\"id\":36,\"first_name\":\"Raoul\",\"last_name\":\"Rice\",\"email\":\"marianne.senger@example.net\",\"birthdate\":\"1989-02-17\",\"added\":\"2020-01-03T21:32:48Z\"},{\"id\":37,\"first_name\":\"Daniela\",\"last_name\":\"Kuphal\",\"email\":\"dino11@example.net\",\"birthdate\":\"2010-08-05\",\"added\":\"2002-06-12T15:11:47Z\"},{\"id\":38,\"first_name\":\"Kevon\",\"last_name\":\"Labadie\",\"email\":\"vinnie19@example.com\",\"birthdate\":\"2010-12-20\",\"added\":\"1999-05-31T18:10:11Z\"},{\"id\":39,\"first_name\":\"Juston\",\"last_name\":\"King\",\"email\":\"serenity60@example.net\",\"birthdate\":\"2013-01-15\",\"added\":\"1997-05-26T03:21:53Z\"},{\"id\":40,\"first_name\":\"Eldridge\",\"last_name\":\"Kuhn\",\"email\":\"franecki.sidney@example.net\",\"birthdate\":\"1998-09-12\",\"added\":\"1975-02-11T15:13:16Z\"},{\"id\":41,\"first_name\":\"Nicola\",\"last_name\":\"Botsford\",\"email\":\"o'kon.river@example.com\",\"birthdate\":\"1987-12-30\",\"added\":\"1975-03-15T09:24:58Z\"},{\"id\":42,\"first_name\":\"Pinkie\",\"last_name\":\"Monahan\",\"email\":\"eupton@example.net\",\"birthdate\":\"1980-10-15\",\"added\":\"1998-09-07T01:40:11Z\"},{\"id\":43,\"first_name\":\"Ena\",\"last_name\":\"Swaniawski\",\"email\":\"agustina16@example.com\",\"birthdate\":\"2019-06-21\",\"added\":\"2009-03-31T20:35:47Z\"},{\"id\":44,\"first_name\":\"Rudy\",\"last_name\":\"Senger\",\"email\":\"krajcik.aylin@example.com\",\"birthdate\":\"2010-05-09\",\"added\":\"1999-05-26T18:35:18Z\"},{\"id\":45,\"first_name\":\"Lela\",\"last_name\":\"Marquardt\",\"email\":\"mcclure.angel@example.net\",\"birthdate\":\"2012-06-19\",\"added\":\"1977-03-17T10:13:14Z\"},{\"id\":46,\"first_name\":\"Sabryna\",\"last_name\":\"Grimes\",\"email\":\"dgreenfelder@example.org\",\"birthdate\":\"1998-03-16\",\"added\":\"2003-05-21T00:31:51Z\"},{\"id\":47,\"first_name\":\"Dereck\",\"last_name\":\"McGlynn\",\"email\":\"orlo35@example.net\",\"birthdate\":\"2012-01-23\",\"added\":\"1994-06-30T14:17:30Z\"},{\"id\":48,\"first_name\":\"Jacky\",\"last_name\":\"Kihn\",\"email\":\"christa.emmerich@example.net\",\"birthdate\":\"1999-04-28\",\"added\":\"2016-04-09T14:46:46Z\"},{\"id\":49,\"first_name\":\"Vincenza\",\"last_name\":\"Koelpin\",\"email\":\"friesen.jaden@example.net\",\"birthdate\":\"1994-01-03\",\"added\":\"2019-03-22T02:54:25Z\"},{\"id\":50,\"first_name\":\"Don\",\"last_name\":\"Farrell\",\"email\":\"isabel.fadel@example.net\",\"birthdate\":\"1977-01-07\",\"added\":\"1995-11-06T01:32:39Z\"},{\"id\":51,\"first_name\":\"Declan\",\"last_name\":\"Morar\",\"email\":\"lmills@example.org\",\"birthdate\":\"1974-07-08\",\"added\":\"2003-01-21T00:19:38Z\"},{\"id\":52,\"first_name\":\"Carrie\",\"last_name\":\"Doyle\",\"email\":\"alexzander83@example.org\",\"birthdate\":\"1997-03-23\",\"added\":\"1996-07-15T08:40:18Z\"},{\"id\":53,\"first_name\":\"Mack\",\"last_name\":\"Romaguera\",\"email\":\"bayer.kaylee@example.org\",\"birthdate\":\"2010-04-07\",\"added\":\"2005-03-20T04:41:26Z\"},{\"id\":54,\"first_name\":\"Edwardo\",\"last_name\":\"Strosin\",\"email\":\"cbrakus@example.org\",\"birthdate\":\"1979-03-29\",\"added\":\"1981-03-23T11:27:30Z\"},{\"id\":55,\"first_name\":\"Rosemarie\",\"last_name\":\"Fadel\",\"email\":\"alejandrin92@example.com\",\"birthdate\":\"2013-03-31\",\"added\":\"2001-11-01T18:59:24Z\"},{\"id\":56,\"first_name\":\"Bartholome\",\"last_name\":\"Paucek\",\"email\":\"terrill.fritsch@example.net\",\"birthdate\":\"2003-01-16\",\"added\":\"1986-10-07T19:49:35Z\"},{\"id\":57,\"first_name\":\"Reilly\",\"last_name\":\"Ryan\",\"email\":\"danial51@example.com\",\"birthdate\":\"1993-07-30\",\"added\":\"2008-03-08T07:29:48Z\"},{\"id\":58,\"first_name\":\"Wilfred\",\"last_name\":\"Jerde\",\"email\":\"aniyah.berge@example.org\",\"birthdate\":\"1988-05-14\",\"added\":\"1994-05-08T06:43:10Z\"},{\"id\":59,\"first_name\":\"Marlee\",\"last_name\":\"Kozey\",\"email\":\"o'reilly.eugenia@example.org\",\"birthdate\":\"2019-07-05\",\"added\":\"1988-01-26T11:00:47Z\"},{\"id\":60,\"first_name\":\"Lenny\",\"last_name\":\"Feeney\",\"email\":\"naomi45@example.com\",\"birthdate\":\"2019-11-14\",\"added\":\"2015-04-22T18:17:34Z\"},{\"id\":61,\"first_name\":\"Hubert\",\"last_name\":\"Macejkovic\",\"email\":\"alden.schumm@example.com\",\"birthdate\":\"1997-05-09\",\"added\":\"1978-05-29T15:31:25Z\"},{\"id\":62,\"first_name\":\"Harold\",\"last_name\":\"Gorczany\",\"email\":\"shanna33@example.net\",\"birthdate\":\"1998-10-12\",\"added\":\"1999-02-06T06:15:15Z\"},{\"id\":63,\"first_name\":\"Cornelius\",\"last_name\":\"Christiansen\",\"email\":\"mozell31@example.org\",\"birthdate\":\"1988-04-03\",\"added\":\"1972-05-10T10:31:58Z\"},{\"id\":64,\"first_name\":\"Iva\",\"last_name\":\"Kreiger\",\"email\":\"mtreutel@example.org\",\"birthdate\":\"2004-11-14\",\"added\":\"1980-11-28T14:51:04Z\"},{\"id\":65,\"first_name\":\"Ettie\",\"last_name\":\"Stamm\",\"email\":\"klein.ara@example.org\",\"birthdate\":\"2007-03-23\",\"added\":\"2012-08-27T20:54:49Z\"},{\"id\":66,\"first_name\":\"Adrian\",\"last_name\":\"Greenholt\",\"email\":\"xcassin@example.net\",\"birthdate\":\"2017-06-05\",\"added\":\"1984-01-18T19:27:48Z\"},{\"id\":67,\"first_name\":\"Lupe\",\"last_name\":\"Toy\",\"email\":\"irunolfsson@example.com\",\"birthdate\":\"1990-04-15\",\"added\":\"1982-02-01T10:15:29Z\"},{\"id\":68,\"first_name\":\"Francisca\",\"last_name\":\"Little\",\"email\":\"schuppe.scarlett@example.net\",\"birthdate\":\"2016-03-09\",\"added\":\"2018-04-03T03:02:11Z\"},{\"id\":69,\"first_name\":\"Ida\",\"last_name\":\"Erdman\",\"email\":\"graciela.schinner@example.com\",\"birthdate\":\"1997-05-06\",\"added\":\"1976-11-14T18:05:03Z\"},{\"id\":70,\"first_name\":\"Kassandra\",\"last_name\":\"Schmeler\",\"email\":\"anderson.annetta@example.net\",\"birthdate\":\"1993-11-04\",\"added\":\"1993-07-23T05:07:20Z\"}]";
        List<AuthorDTO> authorDTOS = JsonUtils.jsonToObj(data, new TypeReference<List<AuthorDTO>>() {});
        responseMsg.setListAuthors(authorDTOS);
        responseMsg.setResult(70);
        responseMsg.setDescription("Success");
        nextTask.handle(input);
    }
}
